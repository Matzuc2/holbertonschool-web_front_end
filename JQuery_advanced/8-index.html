<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8" />
        <title>Task 4</title>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous">
    </script>
    </head>
    <body>
    <script type="application/javascript">
            jQuery(document).ready(function () {
               createSearchForm();
               if (jQuery.ajax){
                console.log("ajax methods available")
               }
            })
            function createSearchForm(){
                jQuery("body")
                    .append(jQuery("<input type='text'></input>"))
                    .append(jQuery("<input type='submit' value='Submit'></input>").click(function(){
                        queryWikipedia(jQuery("input").val())
                    }))
                    .append("<ul></ul>")
                    .append(jQuery("<ul id='pagination'></ul>"))
            }

            function addNewArticle(id, title, snippet){
                let li = jQuery("<li></li>")
                    .append(jQuery("<p></p>")
                        .append(jQuery("<span></span>").text(`${id} - `), jQuery("<b></b>").text(`${title}`) )
                    )
                    .append(jQuery("<p></p>").html(snippet))
                jQuery("ul").first().append(li)
            }

            function queryWikipedia(search, number=0){
                jQuery.ajax({
                    url: "https://en.wikipedia.org/w/api.php",
                    data: {
                        action: "query",
                        list: "search",
                        srsearch: search,
                        format: "json",
                        sroffset: number * 10 
                    },
                    dataType: "jsonp",
                    success: function(response) {
                        jQuery("ul").first().empty()
                        response.query.search.forEach(function(result) {
                            addNewArticle(result.pageid, result.title, result.snippet);
                        });
                        buildPagination(response.query.searchinfo.totalhits, 10, number * 10)
                    }
                });
            }

            function buildPagination(numberOfItems, itemsPerPage, currentOffset){
                jQuery("#pagination").empty()
                for(let i= 0; i < numberOfItems / itemsPerPage; i++){
                    let fontWeight = (i * itemsPerPage === currentOffset) ? "bold" : "normal";
                    jQuery("#pagination").append(
                        jQuery(`<li></li>`)
                            .text(i + 1)
                            .css({
                                "cursor": 'pointer', 
                                "margin-left": "10px", 
                                "display": "inline",
                                "font-weight": fontWeight
                            })
                            .click(function (){
                                jQuery("#pagination li").css("font-weight", "normal");
                                jQuery(this).css("font-weight", "bold");
                                queryWikipedia(jQuery("input").val(), i)
                            })
                        )
                }
            }
    </script>
    </body>
</html>